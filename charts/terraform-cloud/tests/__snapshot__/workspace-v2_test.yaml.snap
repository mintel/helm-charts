Test backstage.io/component tag can be overidden:
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: dev
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: ""
      allowDestroyPlan: true
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: dev-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      executionMode: agent
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:dev
        - owner:sre
        - mod:s3
        - allow-destroy:true
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: dev
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: enable_versioning
          sensitive: false
          value: "false"
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-app
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-app/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "test-app"
              Component = "test-app"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "test-app-override"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: dev
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: e28064ca9275773798102e6e223627ac92cb8ddf243a9bb5ffcd8a2bc41774f8
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: enable_versioning
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: dev-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
Test tags:
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: ""
      allowDestroyPlan: true
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      executionMode: agent
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:prod
        - owner:sre
        - mod:s3
        - allow-destroy:true
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: prod
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-app
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-app/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "test-app"
              Component = "test-app"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "test-app"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: 99e5dc40275ddb90f2c2dfa7b910edec9c4a528daf6b5aba75cae5b6e083fbc1
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
Test tags with env/allow-destroy flags changed:
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: logs
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: logs-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: ""
      allowDestroyPlan: false
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: logs-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      executionMode: agent
      name: logs-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:logs
        - owner:sre
        - mod:s3
        - allow-destroy:false
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: logs
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-app
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-app/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "test-app"
              Component = "test-app"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "test-app"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: logs
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: logs-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: 0f975eb550c4a89f63172c34bb32c6694a8bf8a19f761f0492e74b22bf8eb38f
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: logs-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
Test teamAccess can be configured:
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: logs
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: logs-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: ""
      allowDestroyPlan: false
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: logs-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      executionMode: agent
      name: logs-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:logs
        - owner:sre
        - mod:s3
        - allow-destroy:false
        - kubernetes-managed
      teamAccess:
        - access: admin
          team:
            name: test-admin-team
        - access: write
          team:
            name: test-app-team
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: logs
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-app
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-app/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "test-app"
              Component = "test-app"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "test-app"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: logs
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: logs-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: 0f975eb550c4a89f63172c34bb32c6694a8bf8a19f761f0492e74b22bf8eb38f
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: logs-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
Test workspace allow destroy env:
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: ""
      allowDestroyPlan: false
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      executionMode: agent
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:prod
        - owner:sre
        - mod:s3
        - allow-destroy:false
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: prod
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-app
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-app/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "test-app"
              Component = "test-app"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "test-app"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: 99e5dc40275ddb90f2c2dfa7b910edec9c4a528daf6b5aba75cae5b6e083fbc1
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
Test workspace allow destroy env global-override:
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: ""
      allowDestroyPlan: true
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      executionMode: agent
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:prod
        - owner:sre
        - mod:s3
        - allow-destroy:true
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: prod
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-app
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-app/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "test-app"
              Component = "test-app"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "test-app"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: 99e5dc40275ddb90f2c2dfa7b910edec9c4a528daf6b5aba75cae5b6e083fbc1
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
Test workspace allow destroy env resource-override:
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: ""
      allowDestroyPlan: true
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      executionMode: agent
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:prod
        - owner:sre
        - mod:s3
        - allow-destroy:true
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: prod
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-app
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-app/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "test-app"
              Component = "test-app"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "test-app"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-app-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-app-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-app-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: 72ac1adc61c0362f206edbb4bfe8f37c9759eebf94b224b5488e51895a6baebe
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: prod-eu-west-1-cluster1-test-namespace-mntl-test-app-s3
Test workspace defaults:
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-workspace-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-workspace-s3
        app.mintel.com/env: dev
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-workspace-s3
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: test-agent-pool
      allowDestroyPlan: true
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: dev-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      executionMode: agent
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:dev
        - owner:sre
        - mod:s3
        - allow-destroy:true
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: dev
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: enable_versioning
          sensitive: false
          value: "false"
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-workspace
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-workspace/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "mntl-test-workspace"
              Component = "mntl-test-workspace"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "mntl-test-workspace"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-workspace-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-workspace-s3
        app.mintel.com/env: dev
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-workspace-s3
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: fdbef9d1687038bf53acf2160fd4f030f87d3ac8b0fbbda98eaa5a1815ca8ea7
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: enable_versioning
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: dev-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
Test workspace defaults in prod-like environment (logs):
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-workspace-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-workspace-s3
        app.mintel.com/env: logs
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-workspace-s3
      name: logs-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: test-agent-pool
      allowDestroyPlan: false
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: logs-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      executionMode: remote
      name: logs-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:logs
        - owner:sre
        - mod:s3
        - allow-destroy:false
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: logs
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-workspace
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-workspace/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "mntl-test-workspace"
              Component = "mntl-test-workspace"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "mntl-test-workspace"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-workspace-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-workspace-s3
        app.mintel.com/env: logs
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-workspace-s3
      name: logs-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: 0279807d7d7b509afe8d8bddfd1078f13a2bc9b06ac987bf76da8f390b4acbf8
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: logs-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
Test workspace defaults in prod-like environment (prod):
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-workspace-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-workspace-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-workspace-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: test-agent-pool
      allowDestroyPlan: false
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      executionMode: remote
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:prod
        - owner:sre
        - mod:s3
        - allow-destroy:false
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: prod
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-workspace
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-workspace/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "mntl-test-workspace"
              Component = "mntl-test-workspace"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "mntl-test-workspace"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-workspace-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-workspace-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-workspace-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: a24eac908ad3b5dec83bb9ace67412eba8ce96ec4058243d2af328f2f931d90a
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
Test workspace instance overrides:
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-bucket-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-bucket-s3
        app.mintel.com/env: dev
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-bucket-s3
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-bucket-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: test-agent-pool
      allowDestroyPlan: true
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: dev-eu-west-1-cluster1-test-namespace-mntl-test-bucket-s3
      executionMode: remote
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-bucket-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:dev
        - owner:sre
        - mod:s3
        - allow-destroy:true
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: dev
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: enable_versioning
          sensitive: false
          value: "false"
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-bucket
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-bucket/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "mntl-test-workspace"
              Component = "mntl-test-workspace"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "mntl-test-workspace"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-bucket-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-bucket-s3
        app.mintel.com/env: dev
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-bucket-s3
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-bucket-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: d8cde27cae909d372a9c646782be59ae03a30b41a07b730a198816947093aeb5
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: enable_versioning
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: dev-eu-west-1-cluster1-test-namespace-mntl-test-bucket-s3
  3: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-bucket-another-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-bucket-another-s3
        app.mintel.com/env: dev
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-bucket-another-s3
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-bucket-another-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: test-agent-pool
      allowDestroyPlan: true
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: dev-eu-west-1-cluster1-test-namespace-mntl-test-bucket-another-s3
      executionMode: remote
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-bucket-another-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:dev
        - owner:sre
        - mod:s3
        - allow-destroy:true
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: dev
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: enable_versioning
          sensitive: false
          value: "false"
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-bucket-another
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-bucket-another/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "mntl-test-workspace"
              Component = "mntl-test-workspace"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "mntl-test-workspace"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  4: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-bucket-another-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-bucket-another-s3
        app.mintel.com/env: dev
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-bucket-another-s3
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-bucket-another-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: 3f634f5fd4393adc320236cd9932147e58cda8bfe46202f1ce048570e0d44eb2
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: enable_versioning
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: dev-eu-west-1-cluster1-test-namespace-mntl-test-bucket-another-s3
Test workspace overrides:
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-workspace-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-workspace-s3
        app.mintel.com/env: dev
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-workspace-s3
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: test-agent-pool
      allowDestroyPlan: true
      applyMethod: auto
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: dev-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      executionMode: remote
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:dev
        - owner:sre
        - mod:s3
        - allow-destroy:true
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: dev
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: enable_versioning
          sensitive: false
          value: "false"
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-workspace
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-workspace/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "mntl-test-workspace"
              Component = "mntl-test-workspace"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "mntl-test-workspace"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-workspace-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-workspace-s3
        app.mintel.com/env: dev
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-workspace-s3
      name: dev-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: fdbef9d1687038bf53acf2160fd4f030f87d3ac8b0fbbda98eaa5a1815ca8ea7
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: enable_versioning
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: dev-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
Test workspace overrides at global-config level:
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-workspace-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-workspace-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-workspace-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: test-agent-pool
      allowDestroyPlan: true
      applyMethod: manual
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      executionMode: remote
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:prod
        - owner:sre
        - mod:s3
        - allow-destroy:true
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: prod
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-workspace
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-workspace/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "mntl-test-workspace"
              Component = "mntl-test-workspace"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "mntl-test-workspace"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-workspace-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-workspace-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-workspace-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: a24eac908ad3b5dec83bb9ace67412eba8ce96ec4058243d2af328f2f931d90a
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
Test workspace overrides at resource-config level:
  1: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Workspace
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-workspace-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-workspace-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-workspace-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      namespace: test-namespace
    spec:
      agentPool:
        id: test-agent-pool
      allowDestroyPlan: true
      applyMethod: manual
      environmentVariables:
        - hcl: false
          name: TF_AWS_DEFAULT_TAGS_TerraformCloudWorkspace
          sensitive: false
          value: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      executionMode: remote
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      organization: Mintel
      sshKey:
        name: mintel-ssh
      tags:
        - env:prod
        - owner:sre
        - mod:s3
        - allow-destroy:true
        - kubernetes-managed
      terraformVariables:
        - hcl: false
          name: aws_account_name
          sensitive: false
          value: prod
        - hcl: false
          name: aws_region
          sensitive: false
          value: eu-west-1
        - hcl: false
          name: eks_cluster_name
          sensitive: false
          value: cluster1
        - hcl: false
          name: name
          sensitive: false
          value: mntl-test-workspace
        - hcl: false
          name: output_secret_name
          sensitive: false
          value: test-namespace/mntl-test-workspace/s3
        - hcl: true
          name: secret_tags
          sensitive: false
          value: '{access-project = "test-namespace-ops"}'
        - hcl: true
          name: tags
          sensitive: false
          value: |-
            {
              Application = "mntl-test-workspace"
              Component = "mntl-test-workspace"
              Owner = "sre"
              Project = "test-project"
              backstage.io/component = "mntl-test-workspace"
            }
        - hcl: false
          name: tfcloud_agent
          sensitive: false
          value: "true"
      terraformVersion: 1.3.10
      token:
        secretKeyRef:
          key: token
          name: terraformrc
  2: |
    apiVersion: app.terraform.io/v1alpha2
    kind: Module
    metadata:
      annotations:
        app.mintel.com/altManifestFileSuffix: mntl-test-workspace-s3
        app.mintel.com/placeholder: placeholder
        argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
        argocd.argoproj.io/sync-wave: "-40"
      labels:
        app.kubernetes.io/name: mntl-test-workspace-s3
        app.mintel.com/env: prod
        app.mintel.com/owner: sre
        app.mintel.com/region: eu-west-1
        name: mntl-test-workspace-s3
      name: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
      namespace: test-namespace
    spec:
      destroyOnDeletion: true
      module:
        source: app.terraform.io/Mintel/private-s3-bucket/aws
        version: 3.0.2
      name: operator
      organization: Mintel
      restartedAt: 794cdc7cf7e839f75fecdaa69bf878a0eb05278e560e5279a48d1d2edd15dc44
      token:
        secretKeyRef:
          key: token
          name: terraformrc
      variables:
        - name: aws_account_name
        - name: aws_region
        - name: eks_cluster_name
        - name: name
        - name: output_secret_name
        - name: secret_tags
        - name: tags
        - name: tfcloud_agent
      workspace:
        name: prod-eu-west-1-cluster1-test-namespace-mntl-test-workspace-s3
